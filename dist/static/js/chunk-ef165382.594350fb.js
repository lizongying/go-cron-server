(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ef165382"],{"0306":function(e,t,r){},"1c4c":function(e,t,r){"use strict";var l=r("9b43"),i=r("5ca1"),s=r("4bf8"),a=r("1fa8"),o=r("33a4"),n=r("9def"),c=r("f1ae"),u=r("27ee");i(i.S+i.F*!r("5cc5")((function(e){Array.from(e)})),"Array",{from:function(e){var t,r,i,d,p=s(e),f="function"==typeof this?this:Array,v=arguments.length,b=v>1?arguments[1]:void 0,h=void 0!==b,g=0,m=u(p);if(h&&(b=l(b,v>2?arguments[2]:void 0,2)),void 0==m||f==Array&&o(m))for(t=n(p.length),r=new f(t);t>g;g++)c(r,g,h?b(p[g],g):p[g]);else for(d=m.call(p),r=new f;!(i=d.next()).done;g++)c(r,g,h?a(d,b,[i.value,g],!0):i.value);return r.length=g,r}})},"261f":function(e,t,r){"use strict";r.r(t);var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",[r("el-form-item",[r("el-select",{attrs:{placeholder:"server"},model:{value:e.server,callback:function(t){e.server=t},expression:"server"}},e._l(e.servers,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),r("div",{staticStyle:{position:"relative",display:"inline-block",width:"195px"}},[r("el-select",{staticStyle:{position:"absolute",left:"0"},attrs:{placeholder:"group"},model:{value:e.rule,callback:function(t){e.rule=t},expression:"rule"}},e._l(e.rules,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v(" "),r("el-input",{staticStyle:{width:"160px"},attrs:{clearable:"",placeholder:"group"},model:{value:e.rule,callback:function(t){e.rule=t},expression:"rule"}})],1),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.onSave}},[e._v("Save filter")]),e._v(" "),r("el-button",{on:{click:e.onDelete}},[e._v("Delete filter")]),e._v(" "),r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.dialogAdd}},[e._v("Add")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogTableVisible,"modal-append-to-body":!1,"show-close":!0,"before-close":e.dialogCancel}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rulesForm}},[r("el-form-item",{attrs:{label:"Script",prop:"script","label-width":e.formLabelWidth}},[r("el-input",{style:e.inputWidth,attrs:{type:"textarea",placeholder:"Script"},model:{value:e.form.script,callback:function(t){e.$set(e.form,"script",t)},expression:"form.script"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Dir",prop:"dir","label-width":e.formLabelWidth}},[r("el-input",{style:e.inputWidth,attrs:{placeholder:"Dir"},model:{value:e.form.dir,callback:function(t){e.$set(e.form,"dir",t)},expression:"form.dir"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Spec",prop:"spec","label-width":e.formLabelWidth}},[r("el-input",{style:e.inputWidth,attrs:{placeholder:"Spec"},model:{value:e.form.spec,callback:function(t){e.$set(e.form,"spec",t)},expression:"form.spec"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Group",prop:"group","label-width":e.formLabelWidth}},[r("el-input",{style:e.inputWidth,attrs:{placeholder:"Group"},model:{value:e.form.group,callback:function(t){e.$set(e.form,"group",t)},expression:"form.group"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Enable",prop:"enable","label-width":e.formLabelWidth}},[r("el-switch",{style:e.inputWidth,model:{value:e.form.enable,callback:function(t){e.$set(e.form,"enable",t)},expression:"form.enable"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.dialogCancel}},[e._v("Cancel")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.dialogSure}},[e._v("Save")])],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.listFilter,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":"","default-sort":{prop:"id",order:"ascending"}}},[r("el-table-column",{attrs:{label:"ID",width:"50",align:"center",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"id",sortable:"",label:"TaskID"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.id)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"script",sortable:"",label:"Script"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.script)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"dir",sortable:"",label:"Dir"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.dir)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"spec",sortable:"",label:"Spec"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.spec)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"group",sortable:"",label:"Group"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.group)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"prev",sortable:"",label:"Prev",width:"190",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("i",{staticClass:"el-icon-time"}),e._v("\n        "+e._s(t.row.prev)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"next",sortable:"",label:"Next",width:"190",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("i",{staticClass:"el-icon-time"}),e._v("\n        "+e._s(t.row.next)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"state",sortable:"",label:"JobState",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:e._f("statusFilter")(t.row.state)}},[e._v(e._s(t.row.state))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"enable",sortable:"",label:"Enable",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{staticClass:"operation",attrs:{type:e._f("statusFilter")(t.row.enable)},on:{click:function(r){return e.enable(t.row.enable,t.row.id)}}},[e._v(e._s(t.row.enable))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"Operation",width:"200",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{staticClass:"operation",attrs:{type:"blue"},on:{click:function(r){return e.remove(t.row.id)}}},[e._v("Remove")]),e._v(" "),r("el-tag",{staticClass:"operation",attrs:{type:"blue"},on:{click:function(r){return e.dialogUpdate(t.row.id)}}},[e._v("Edit")])]}}])})],1)],1)},i=[],s=(r("1c4c"),r("7f7f"),r("456d"),r("3b2b"),r("ac6a"),r("5df3"),r("4f7f"),r("b775"));function a(e){return Object(s["a"])({url:"/api/cron/list",method:"post",data:e})}function o(e){return Object(s["a"])({url:"/api/cron/add",method:"post",data:e})}function n(e){return Object(s["a"])({url:"/api/cron/remove",method:"post",data:e})}function c(e){return Object(s["a"])({url:"/api/cron/start",method:"post",data:e})}function u(e){return Object(s["a"])({url:"/api/cron/stop",method:"post",data:e})}var d={filters:{statusFilter:function(e){var t={RUN:"success",DEF:"danger"};return t[e]}},data:function(){return{RUN:"RUN",DEF:"DEF",list:[],listLoading:!0,rule:".*",rules:new Set([".*"]),server:"",servers:[],formLabelWidth:"100px",inputWidth:"width:100%;",dialogTableVisible:!1,dialogTitle:"",dialogContent:"",form:{id:"",script:"",dir:"",spec:"",group:"",enable:!0},rulesForm:{script:[{required:!0,message:"Script is empty",trigger:"blur"}],spec:[{required:!0,message:"Spec is empty",trigger:"blur"}]},clients:{},ids:[]}},computed:{listFilter:function(){if(this.clients&&this.server&&this.clients[this.server]){var e=new RegExp(this.rule);return this.clients[this.server].filter((function(t){return e.test(t.group)}))}return[]}},mounted:function(){localStorage.rules&&"{}"!==localStorage.rules&&(this.rules=new Set(JSON.parse(localStorage.rules))),localStorage.rule&&(this.rule=localStorage.rule),localStorage.server&&(this.server=localStorage.server)},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.listLoading=!0;var t={};a(t).then((function(t){e.clients=t.data,e.servers=Object.keys(t.data),e.servers.length&&(e.server=e.servers[0]),e.listLoading=!1}))},fresh:function(e){var t=this;this.listLoading=!0;var r={server:this.server,group:this.list[e].group,name:this.list[e].name};status(r).then((function(r){r.data.idx=e,t.$set(t.list,e,r.data),t.listLoading=!1,t.$message(t.list[e].group+" fresh!")}))},remove:function(e){var t=this;this.listLoading=!0;var r={id:e};n(r).then((function(r){t.clients[t.server]=t.clients[t.server].filter((function(t){return t.id!==e})),t.listLoading=!1,t.$message("removed: "+e)}))},enable:function(e,t){var r=this;this.listLoading=!0;var l={id:t};e?u(l).then((function(e){r.clients[r.server]=r.clients[r.server].map((function(e){return e.id===t&&(e.enable=!1),e})),r.listLoading=!1,r.$message("stopped: "+t)})):c(l).then((function(e){r.clients[r.server]=r.clients[r.server].map((function(e){return e.id===t&&(e.enable=!0),e})),r.listLoading=!1,r.$message("started: "+t)}))},onSave:function(){this.rules.add(this.rule),this.rules=new Set(Array.from(this.rules)),localStorage.rules=JSON.stringify(Array.from(this.rules)),localStorage.rule=this.rule,localStorage.server=this.server},onDelete:function(){this.rules.delete(this.rule),this.rules=new Set(Array.from(this.rules)),localStorage.rules=JSON.stringify(Array.from(this.rules)),this.rule=".*",localStorage.rule=this.rule,this.server=this.servers[0],localStorage.server=this.servers[0]},dialogCancel:function(){this.dialogTableVisible=!1},dialogAdd:function(){this.form={id:"",script:"",dir:"",spec:"",group:"",enable:!0},this.dialogTitle="Add",this.dialogTableVisible=!0},dialogUpdate:function(e){var t=this;this.clients[this.server].every((function(r){return r.id!==e||(t.form={id:r.id,script:r.script,dir:r.dir,spec:r.spec,group:r.group,enable:r.enable},!1)})),this.dialogTitle="Edit",this.dialogTableVisible=!0},dialogSure:function(){var e=this;this.$refs["form"].validate((function(t){if(t){e.listLoading=!0;var r=e.form;e.form.id?o(r).then((function(t){e.listLoading=!1,0===t.code?(e.clients[e.server]=e.clients[e.server].map((function(e){return e.id===r.id&&(e.script=r.script,e.dir=r.dir,e.spec=r.spec,e.group=r.group,e.prev=r.prev,e.next=r.next,e.state=r.state,e.enable=r.enable),e})),e.$message("Success")):e.$message("Error"),e.dialogTableVisible=!1})):(r.id=3,o(r).then((function(t){e.listLoading=!1,0===t.code?(e.clients[e.server].push({id:r.id,script:r.script,dir:r.dir,spec:r.spec,group:r.group,prev:"0000-00-00 00:00:00",next:"0000-00-00 00:00:00",state:"DEF",enable:r.enable}),e.$message("Success")):e.$message("Error"),e.dialogTableVisible=!1})))}}))}}},p=d,f=(r("45de"),r("2877")),v=Object(f["a"])(p,l,i,!1,null,"6af31216",null);t["default"]=v.exports},"456d":function(e,t,r){var l=r("4bf8"),i=r("0d58");r("5eda")("keys",(function(){return function(e){return i(l(e))}}))},"45de":function(e,t,r){"use strict";var l=r("0306"),i=r.n(l);i.a},"5eda":function(e,t,r){var l=r("5ca1"),i=r("8378"),s=r("79e5");e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],a={};a[e]=t(r),l(l.S+l.F*s((function(){r(1)})),"Object",a)}},f1ae:function(e,t,r){"use strict";var l=r("86cc"),i=r("4630");e.exports=function(e,t,r){t in e?l.f(e,t,i(0,r)):e[t]=r}}}]);